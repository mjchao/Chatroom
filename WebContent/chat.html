<!DOCTYPE html>
<html>
	<head>
		<title>Chatroom</title>
		
		<link href="css/styles.css" type="text/css" rel="stylesheet" />
		
		<style type="text/css">
			#pnlPadding {
				float: left;
				border-bottom: 1px solid black;
				padding-bottom: 0px;
			}
		
			#pnlMain {
				float: left;
				overflow: hidden;
				padding-left: 0px;
				padding-right: 0px;
				margin-left: -6px;
				margin-right: -6px;
				margin-bottom: 0px;
			}
		
			#pnlMain>div {
				float: left;
				border: 1px solid black;
				margin-bottom: -1000px;
				padding-bottom: 1000px;
			}
		</style>
	</head>
	<body>
		<div id="pnlPadding">
			<div id="pnlMain">
				<div id="pnlCenter">
					<div id="pnlUserData">
						<label id="lblDisplayName"> Hello </label>
						<input type="button" name="cmdLogout" value="Logout" onclick="cmdLogout_Click()"/>
					</div>
					<div id="pnlChatHistory">
						<textarea name="txtChatHistory" rows="20" cols="50" readonly="readonly"></textarea>
					</div>
					<div id="pnlSend">
						<input type="text" name="txtMessage" size="50" placeholder="Enter message" onkeypress="txtMessage_KeyPress( event )"/>
						<input type="button" name="cmdSend" value="Send" onclick="cmdSend_Click();"/>	
					</div>
				</div>
				<div id="pnlUserList">
					<label id="lblUserList">Active Users</label><br />
					<input type="button" name="cmdUser1" value="User1"/><br />
					<input type="button" name="cmdUser2" value="User2"/><br />
				</div>
			</div>
		</div>
		<p style="clear: both; padding-top: 10px;">Test</p>
		
		<script type="text/javascript">
			window.onload = showDisplayName();
			
			var VK_ENTER = 13
			
			function sendMessage( message ) {
				
				//do not send empty messages to the chat server
				if ( message != "") {
					alert( "Sending message to server: " + message );
				}
			}
			
			function txtMessage_KeyPress( e ) {
				if ( !e ) {
					e = window.event;
				}
				keycode = e.which || e.keycode;
				if ( keycode === VK_ENTER ) {
					cmdSend_Click();
				}
			}
		
			function cmdSend_Click() {
				var message = txtMessage.value;
				sendMessage( message );
				
				//clear the message text box
				txtMessage.value = ""
			}
			
			function cmdLogout_Click() {
				window.location.href = "login.html"
			}
			
			function showDisplayName() {
				var formInput = window.location.search;
				
				//replace all "+"s with " "s
				while( formInput.indexOf( "+" ) != -1 ) {
					formInput = formInput.replace( "+" , " " );
				}
				
				var displayName = formInput.substring( formInput.indexOf( "displayName=" )+12 , formInput.length );
				var lblDisplayName = document.getElementById( "lblDisplayName" );
				lblDisplayName.innerHTML = "Logged in as <span class=\"displayNameText\">" + displayName + "</span>";
			}
		</script>
	</body>
</html>